<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />

    <!-- BOOTSTRAP 4! -->
    <!-- <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap4.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.bootstrap4.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.3.0/css/responsive.bootstrap4.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/fixedheader/3.2.4/css/fixedHeader.bootstrap4.min.css"/>

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap4.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.bootstrap4.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.colVis.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.3.0/js/responsive.bootstrap4.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/fixedheader/3.2.4/js/dataTables.fixedHeader.min.js"></script> -->
    <!-- BOOTSTRAP 4! -->

    <!-- BOOTSTRAP 5! -->
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.bootstrap5.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/fixedheader/3.2.4/css/fixedHeader.bootstrap5.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/responsive/2.3.0/css/responsive.bootstrap5.min.css"
    />

    <script
      type="text/javascript"
      src="https://code.jquery.com/jquery-3.6.0.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.bootstrap5.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.colVis.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/fixedheader/3.2.4/js/dataTables.fixedHeader.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/responsive/2.3.0/js/responsive.bootstrap5.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/plug-ins/1.12.1/filtering/row-based/TableTools.ShowSelectedOnly.js"
    ></script>
    <!-- BOOTSTRAP 5! -->

    <style>
      main {
        display: flex;
        flex-direction: column;
        margin: 30px auto;
        height: 90vh;
        max-height: 100vh;
        max-width: 100vw;
        width: 90vw;
      }
      //COLUMN HEADER ELEMENT
      .table > thead {
        background-color: var(--bs-gray-800);
        color: var(--bs-gray-100);
        border-color: var(--bs-gray-800);
      }
      //COLUMN HEADER ELEMENT

      td.upper {
        text-transform: uppercase;
      }
    </style>
  </head>

  <body>
    <!-- HEADER ELEMENT -->
    <header></header>
    <!-- HEADER ELEMENT -->

    <!-- MAIN ELEMENT -->
    <main>
      <div class="container-fluid">
        <br />
        <div class="row table-responsive">
          <table
            id="cust-table"
            class="table table-hover table-sm table-bordered dt-responsive nowrap"
            style="width: 100%"
          ></table>
        </div>
      </div>
    </main>
    <!-- MAIN ELEMENT -->

    <!-- SCRIPT LINK -->

    <!-- SCRIPT LINK -->

    <!-- FOOTER ELEMENT -->
    <footer></footer>
    <!-- FOOTER ELEMENT -->

    <!-- WRITTEN SCRIPT -->
    <script>
      document.addEventListener("DOMContentLoaded", pageLoad)

      function pageLoad() {
        loadData()
      }

      function loadData() {
        google.script.run
          .withSuccessHandler((jsData) => {
            const table = new DataTable("#cust-table", {
              // options
              data: jsData,
              language: {
                decimal: ",",
                thousands: ".",
              },
              columns: [
                { data: "Date", title: "Date" },
                { data: "Receipt", title: "Receipt" },
                { data: "Name", title: "Name" },
                { data: "Address", title: "Address" },
                { data: "CCY", title: "CCY", className: "upper" },
                { data: "Amount", title: "Amount", className: "dt-body-right" },
                { data: "Total", title: "Total", className: "dt-body-right" },
                { data: "Employee", title: "Employee" },
                { data: "Branch", title: "Branch" },
              ],
              fixedHeader: true,
              dom:
                "<'row'<'col-sm-12 col-md-4'l><'col-sm-12 col-md-4'B><'col-sm-12 col-md-4'f>>" +
                "<'row'<'col-sm-12'tr>>" +
                "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
              buttons: ["colvis", "print", "csv"],
              pageLength: 50,
            })
          })
          .withFailureHandler((er) => {})
          .datatableView()
      }
    </script>
    <!-- WRITTEN SCRIPT -->
  </body>
</html>
